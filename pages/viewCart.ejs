<!--
=========================================================
* Soft UI Design System - v1.0.5
=========================================================

* Product Page:  https://www.creative-tim.com/product/soft-ui-design-system 
* Copyright 2021 Creative Tim (https://www.creative-tim.com)

Coded by www.creative-tim.com

 =========================================================

* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. -->
<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link rel="apple-touch-icon" sizes="76x76" href="/img/apple-icon.png" />
    <link rel="icon" type="image/png" href="/img/favicon.png" />
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css" />
    <title>involvesMe. | Product</title>
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />

    <!--     Fonts and icons     -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Quicksand" rel="stylesheet" />

    <!-- Nucleo Icons -->
    <link href="/css/nucleo-icons.css" rel="stylesheet" />
    <link href="/css/nucleo-svg.css" rel="stylesheet" />
    <!-- Font Awesome Icons -->

    <script src="https://kit.fontawesome.com/42d5adcbca.js" crossorigin="anonymous"></script>
    <link href="/css/nucleo-svg.css" rel="stylesheet" />
    <!-- CSS Files -->
    <link id="pagestyle" href="/css/soft-design-system.css?v=1.0.5" rel="stylesheet" />
    <link href="/css/additional-styles.css" rel="stylesheet" />
</head>

<body>
    <ul class="circles">
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
    </ul>
    <!-- <div>
        Add to cart "For Testing Only"
        <form action="/cart/additem" method="post">
            <input type="text" name="productId" value="61bd8341a5f977e3ef2abe6e">
            <input type="text" name="storeId" value="102937565687195142207">
            <input type="number" name="quantity" value="30" min="1" max="30">
            <button type="submit">Submit</button>
        </form>
    </div> -->
    <section>

        <style>
            table {
                border-collapse: collapse;
            }

            #involves {
                width: 50px;
                height: 50px;
                border-radius: 50px;
            }
        </style>

        <div class="container mx-auto overflow max-height-vh-100 w-100">
            <div class="row">
                <div class="mt-5 d-flex justify-content-between">
                    <div class="container">
                        <div class="row">
                            <div class="col-sm-6 mb-3">
                                <h2>Shopping Cart</h2>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                <table id="productTable" class="table table-condensed table-striped" table
                                    align="center">
                                    <thead>
                                        <tr align="center">
                                            <th>Product Photo</th>
                                            <th>Product Name</th>
                                            <th>Quantity</th>
                                            <th>Price(RM)</th>
                                            <th>Total Price</th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>

                                    <tbody>
                                        <% if(cart !=null) {%>
                                            <%var totalAmount=0;%>
                                            <% for(var i=0; i < cart.products.length; i++){ var action ="notset";%>
                                            
                                                <tr align="center">
                                                    <form action="/cart/edit" method="post">
                                                        <td class="align-middle">
                                                            <img id="involves"
                                                                src="<%=cart.products[i].productThumnail%>" />
                                                        </td>
                                                        <td class="align-middle">
                                                            <%=cart.products[i].name%>
                                                            <input type="text" id="productId" name="productId" value="<%=cart.products[i].product%>" hidden>
                                                        </td>
                                                        <td class="align-middle">

                                                        <span id = "<%="quantity" + i%>"></span>
                                                        <input id = "<%="quantityInput" + i%>" 
                                                            name="newQuantity"
                                                            type="number" 
                                                           
                                                            min = 1
                                                            class="d-none"
                                                           
                                                    
                                                           >

                                                           <%=cart.products[i].quantity%>
                                                           <% if (messages.outstock) {%>
                                                            <p class="text-primary">
                                                                <%= messages.outstock %>
                                                            </p>
                                                             <%}%>
                                                        </td>
                                                        <td class="align-middle">
                                                            <%=cart.products[i].price%>
                                                            <% totalAmount+=(cart.products[i].quantity *cart.products[i].price);%>
                                                        </td>
                                                        <td class="align-middle">

                                                            <%=cart.products[i].totalPrice%>
                                                        </td>
                                                    
                                                        <td class="align-middle">
                                                            <div class="container">
                                                            <div class="row">
                                                                <div class="col">
                                                         

                                                                
                                                                <button type="button"
                                                                   
                                                                    style="color: black; background-color: #1266f1"
                                                                    class="btn mt-3 d-flex display: inline-block;"
                                                                    id= "<%="editItem" + i%>"
                                                                    onclick="enableEdit('<%=i%>')">
                                                                    Edit
                                                                </button>
                                                                <button type="submit"
                                                        
                                                                    class="btn bg-gradient-dark mt-3 d-none"
                                                                    id= "<%="saveChanges" + i%>"
                                                                    onclick="saveChanges('<%=i%>')">
                                                                    <i class="fa fa-check-square-o"></i>
                                                                    Save
                                                                </button>
                                                                <button
                                                            
                                                                    class="btn bg-gradient-dark mt-3 d-none"
                                                                    id= "<%="cancelChanges" + i%>"
                                                                    onclick="cancelChanges('<%=i%>')">
                                                                    <i class="fa fa-window-close-o"></i>
                                                                    Cancel
                                                                </button>
                                                                
                                                           
                                                        </div>
                                                        <div class="col">
                                                        </form>
                                                            <form action="/cart/delete" method="post" onsubmit="return confirm('Are you sure to delete the product?');"　>
                                                                <input type="text" id="productId" name="productId" value="<%=cart.products[i].product%>" hidden>
                                                                <button  id="#btn-submit"
                                                                  class="btn bg-gradient-secondary mt-3 delete">
                                                                Delete
                                                            </button>
                                                        </form>
                                                    </div>
                                                    </div>
                                                    </div>
                                                    </td>
                                                    </div>
                                                    </div>
                                                    </div>
                                                    </div>
                                                </div>
                                                   </div>    
                                                   
                                                </tr>
                                            </div></div>
                                                <% } %>
                                    <tfoot>
                                        <tr align="center">
                                            <td class="align-middle" colspan="5">
                                                
                                                Total Price(RM): <%=totalAmount%>
                                            </td>
                                            <td class="align-middle">
                                                <form action="/pay" method="post">
                                                    <button type="submit" class="btn bg-gradient-primary mt-3">
                                                        Checkout
                                                    </button>
                                                </form> 
                                            </td>
                                        </tr>
                                    </tfoot>
                                    <% }else {%>
                                        <tr align="center">
                                            <td class="align-middle" colspan="6">
                                                Shopping Cart Is Empty
                                            </td>
                                        </tr>
                                        <% } %>
                                            </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>


    <script>

        var edit = "editItem";
        var save = "saveChanges";
        var cancel = "cancelChanges";

        
    
    function enableEdit(index)
     {  
    
        var itemId = edit + index;
        var saveId = save + index;
        var cancelId = cancel + index;
        var quantityId = "quantity" + index;
        var quantityEditId = "quantityInput" + index;
        //console.log(quantityId);
    
        var thisItem = document.getElementById(itemId);
        var saveThis = document.getElementById(saveId);
        var cancelThis = document.getElementById(cancelId);
        var oldQuantity = document.getElementById(quantityId);
        var newQuantity = document.getElementById(quantityEditId);
        //console.log(changeQuantity);
    
        thisItem.classList.add("d-none");
        saveThis.classList.remove("d-none");
        cancelThis.classList.remove("d-none");
        oldQuantity.setAttribute("class" , "d-none");
        newQuantity.removeAttribute("class" ,"d-none");
        newQuantity.value = +oldQuantity.textContent
       
        //console.log(tempQuantity);
        //changeQuantity.style.backgroundColor = "white";
        // var num = 1;
        // console.log(changeQuantity);
        //console.log(changeQuantity.innerText);
        //tempQuantity = changeQuantity.innerText;
    
        // if(isNaN(tempQuantity))
        // {
        //     log.error("wtf");
        // }
    
     }
    
     function cancelChanges(index)
     {
        var itemId = edit + index;
        var saveId = save + index;
        var cancelId = cancel + index;
        var quantityId = "quantity" + index;
        var quantityEditId = "quantityInput" + index;

        var thisItem = document.getElementById(itemId);
        var saveThis = document.getElementById(saveId);
        var cancelThis = document.getElementById(cancelId);
        var oldQuantity = document.getElementById(quantityId);
        var newQuantity = document.getElementById(quantityEditId);
        //console.log(changeQuantity);
    
        thisItem.classList.remove("d-none");
        saveThis.classList.add("d-none");
        cancelThis.classList.add("d-none");
        oldQuantity.setAttribute("class" , "d-block");
        newQuantity.setAttribute("class" ,"d-none");
        console.log(oldQuantity.textContent);
        console.log(newQuantity.textContent);
         
    
        // var test = parseInt(newQuantity.textContent);
        // console.log(test);

        // if(oldQuantity.textContent != newQuantity.textContent)
        // {
        //     newQuantity.innerHTML = oldQuantity.textContent;
        // }


    
     }
    
    </script>




  


    
       

    
<script src="../assets/js/core/popper.min.js" type="text/javascript"></script>
<script src="../assets/js/core/bootstrap.min.js" type="text/javascript"></script>
<script src="../assets/js/plugins/perfect-scrollbar.min.js"></script>
<!--  Plugin for Parallax, full documentation here: https://github.com/wagerfield/parallax  -->
<script src="../assets/js/plugins/parallax.min.js"></script>
<!-- Control Center for Soft UI Kit: parallax effects, scripts for the example pages etc -->
<!--  Google Maps Plugin    -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDTTfWur0PDbZWPr7Pmq8K3jiDp0_xUziI"></script>
<script src="../assets/js/soft-design-system.min.js?v=1.0.5" type="text/javascript"></script>

<!-- modal -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
  integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous">
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
  integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous">
</script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>




</body>

</html>


